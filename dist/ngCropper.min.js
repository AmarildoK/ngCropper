!function(){"use strict";angular.module("ngCropper",[]).directive("ngCropper",function(){return{restrict:"A",scope:{onDone:"=ngDone"},link:function(e,n,t){var o=t.ngShowEvent,r=t.ngHideEvent,i=angular.extend({aspectRatio:"auto",done:e.onDone||angular.noop},t);e.$on(o,function(){n.cropper(i)}),e.$on(r,function(){n.cropper("destroy")})}}}).service("Cropper",["$q",function(e){function n(e){var n=document.createElement("canvas");return n.width=e.width,n.height=e.height,n.style.display="none",document.body.appendChild(n),n}function t(e){e.parentElement.removeChild(e)}this.encode=function(n){var t=e.defer(),o=new FileReader;return o.onload=function(){t.resolve(o.result)},o.readAsDataURL(n),t.promise},this.decode=function(e){for(var n=e.split(";")[0],t=n.split(":")[1],o=atob(e.split(",")[1]),r=new Uint8Array(o.length),i=0;i<o.length;i++)r[i]=o.charCodeAt(i);return new Blob([r],{type:t})},this.crop=function(o,r){var i=e.defer(),a=(o.type,this.decode);return this.encode(o).then(function(e){var c=n(r),d=c.getContext("2d"),u=new Image;u.src=e,d.drawImage(u,r.x,r.y,r.width,r.height,0,0,r.width,r.height);var p=c.toDataURL(o.type),s=a(p);i.resolve(s),t(c)}),i.promise}}])}();
