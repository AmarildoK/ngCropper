!function(){"use strict";angular.module("ngCropper",["ng"]).directive("ngCropper",function(){return{restrict:"A",scope:{options:"=ngOptions"},link:function(e,t,n){var r=!1;e.$on(n.ngShow,function(){r||(r=!0,t.cropper(e.options||{}))}),e.$on(n.ngHide,function(){r&&(r=!1,t.cropper("destroy"))})}}}).service("Cropper",["$q",function(e){function t(e){var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.style.display="none",document.body.appendChild(t),t}function n(e){e.parentElement.removeChild(e)}this.encode=function(t){var n=e.defer(),r=new FileReader;return r.onload=function(){n.resolve(r.result)},r.readAsDataURL(t),n.promise},this.decode=function(e){for(var t=e.split(";")[0],n=t.split(":")[1],r=atob(e.split(",")[1]),o=new Uint8Array(r.length),i=0;i<r.length;i++)o[i]=r.charCodeAt(i);return new Blob([o],{type:n})},this.crop=function(r,o){var i=e.defer(),c=(r.type,this.decode);return this.encode(r).then(function(e){var d=t(o),a=d.getContext("2d"),p=new Image;p.src=e,a.drawImage(p,o.x,o.y,o.width,o.height,0,0,o.width,o.height);var s=d.toDataURL(r.type),h=c(s);i.resolve(h),n(d)}),i.promise}}])}();
